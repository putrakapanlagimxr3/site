<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Media Converter Pro</title>
    <!-- Tambahkan ini untuk HTML2Canvas -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        /* ... Kode CSS Anda tetap sama ... */
    </style>
</head>
<body>
    <!-- ... HTML body Anda tetap sama ... -->

    <!-- GANTI SCRIPT FFMPEG DENGAN VERSI YANG BISA DIPAKAI -->
    <script>
        // Welcome screen transition
        function showTools() {
            const welcomeScreen = document.getElementById('welcomeScreen');
            const mainContent = document.getElementById('mainContent');
            
            welcomeScreen.classList.add('hidden');
            
            setTimeout(() => {
                welcomeScreen.style.display = 'none';
                mainContent.classList.add('visible');
            }, 800);
        }
        
        function backToWelcome() {
            const welcomeScreen = document.getElementById('welcomeScreen');
            const mainContent = document.getElementById('mainContent');
            
            mainContent.classList.remove('visible');
            
            setTimeout(() => {
                welcomeScreen.style.display = 'flex';
                setTimeout(() => {
                    welcomeScreen.classList.remove('hidden');
                }, 50);
            }, 500);
        }
        
        let currentFile = null;
        let currentTool = null;
        
        // Tool navigation
        function openTool(toolName) {
            document.getElementById('toolsGrid').style.display = 'none';
            document.getElementById(toolName).classList.add('active');
            currentTool = toolName;
            
            // Load library khusus untuk tools tertentu
            if (toolName === 'carbon') {
                loadHTML2Canvas();
            }
        }
        
        function closeTool() {
            document.querySelectorAll('.workspace').forEach(ws => ws.classList.remove('active'));
            document.getElementById('toolsGrid').style.display = 'grid';
            resetTool(currentTool);
            currentTool = null;
        }
        
        function resetTool(toolName) {
            const fileInfo = document.getElementById(toolName + 'FileInfo');
            const progress = document.getElementById(toolName + 'Progress');
            const result = document.getElementById(toolName + 'Result');
            const error = document.getElementById(toolName + 'Error');
            const btn = document.getElementById(toolName + 'Btn');
            
            if (fileInfo) fileInfo.style.display = 'none';
            if (progress) progress.classList.remove('active');
            if (result) result.classList.remove('active');
            if (error) error.classList.remove('active');
            if (btn) btn.disabled = true;
            
            currentFile = null;
        }
        
        // File handling - FUNGSI INI DIPERBAIKI
        function setupFileInput(toolName) {
            const fileInput = document.getElementById(toolName + 'File');
            const uploadZone = document.getElementById(toolName + 'Upload');
            
            if (!fileInput || !uploadZone) return;
            
            fileInput.addEventListener('change', (e) => {
                handleFileSelect(toolName, e.target.files[0]);
            });
            
            uploadZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadZone.classList.add('drag-over');
            });
            
            uploadZone.addEventListener('dragleave', () => {
                uploadZone.classList.remove('drag-over');
            });
            
            uploadZone.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadZone.classList.remove('drag-over');
                handleFileSelect(toolName, e.dataTransfer.files[0]);
            });
        }
        
        function handleFileSelect(toolName, file) {
            if (!file) return;
            
            currentFile = file;
            const fileInfo = document.getElementById(toolName + 'FileInfo');
            const btn = document.getElementById(toolName + 'Btn');
            
            if (!fileInfo || !btn) return;
            
            const size = (file.size / (1024 * 1024)).toFixed(2);
            const type = file.type || 'Unknown';
            const extension = file.name.split('.').pop().toUpperCase();
            
            fileInfo.innerHTML = `
                <div class="file-info-row">
                    <span class="file-info-label">Nama:</span>
                    <span class="file-info-value">${file.name}</span>
                </div>
                <div class="file-info-row">
                    <span class="file-info-label">Ukuran:</span>
                    <span class="file-info-value">${size} MB</span>
                </div>
                <div class="file-info-row">
                    <span class="file-info-label">Format:</span>
                    <span class="file-info-value">${extension} (${type})</span>
                </div>
            `;
            
            fileInfo.style.display = 'block';
            btn.disabled = false;
            
            // Untuk tools gambar, tampilkan preview
            if (toolName === 'bgremover' || toolName === 'upscaler') {
                showImagePreview(toolName, file);
            }
        }
        
        function showImagePreview(toolName, file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const previewId = toolName === 'bgremover' ? 'bgremoverOriginal' : 'upscalerOriginal';
                const img = document.getElementById(previewId);
                if (img) {
                    img.src = e.target.result;
                    
                    // Tampilkan container preview
                    const previewContainer = document.getElementById(toolName + 'Preview');
                    if (previewContainer) {
                        previewContainer.style.display = 'block';
                    }
                    
                    // Reset hasil sebelumnya
                    if (toolName === 'upscaler') {
                        const resultCanvas = document.getElementById('upscalerResult');
                        const placeholder = document.getElementById('upscalerPlaceholder');
                        if (resultCanvas) resultCanvas.style.display = 'none';
                        if (placeholder) placeholder.style.display = 'block';
                    }
                }
            };
            reader.readAsDataURL(file);
        }
        
        function showProgress(toolName, show = true) {
            const progress = document.getElementById(toolName + 'Progress');
            if (progress) {
                if (show) {
                    progress.classList.add('active');
                } else {
                    progress.classList.remove('active');
                }
            }
        }
        
        function updateProgress(toolName, percent, text) {
            const bar = document.getElementById(toolName + 'ProgressBar');
            const progressText = document.getElementById(toolName + 'ProgressText');
            if (bar) bar.style.width = percent + '%';
            if (progressText && text) progressText.textContent = text;
        }
        
        function showResult(toolName, blob, filename) {
            const result = document.getElementById(toolName + 'Result');
            const downloadBtn = document.getElementById(toolName + 'Download');
            
            if (!result || !downloadBtn) return;
            
            result.classList.add('active');
            
            downloadBtn.onclick = () => {
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                a.click();
                URL.revokeObjectURL(url);
            };
        }
        
        function showError(toolName, message) {
            const error = document.getElementById(toolName + 'Error');
            if (error) {
                error.textContent = message;
                error.classList.add('active');
            }
        }
        
        // ========================================
        // CONVERTER - SIMULASI (Karena FFmpeg complex)
        // ========================================
        async function convertFile() {
            if (!currentFile) return;
            
            const format = document.getElementById('converterFormat').value;
            
            showProgress('converter');
            updateProgress('converter', 10, 'Mempersiapkan file...');
            
            // Simulasi proses
            await simulateProcess('converter', 2000);
            
            // Buat file dummy untuk demo
            const newFilename = currentFile.name.replace(/\.[^/.]+$/, '') + '_converted.' + format;
            const dummyText = `File converted to ${format}\nOriginal: ${currentFile.name}\nSize: ${(currentFile.size/1024/1024).toFixed(2)}MB`;
            const blob = new Blob([dummyText], { type: 'text/plain' });
            
            showResult('converter', blob, newFilename);
            showProgress('converter', false);
        }
        
        // ========================================
        // VIDEO TRIMMER - SIMULASI
        // ========================================
        async function trimVideo() {
            if (!currentFile) return;
            
            const startTime = parseFloat(document.getElementById('trimStart').value);
            const endTime = parseFloat(document.getElementById('trimEnd').value);
            
            if (endTime <= startTime) {
                showError('trimmer', 'End time harus lebih besar dari start time');
                return;
            }
            
            showProgress('trimmer');
            updateProgress('trimmer', 10, 'Memproses video...');
            
            // Simulasi proses
            await simulateProcess('trimmer', 2500);
            
            // Buat file dummy untuk demo
            const newFilename = currentFile.name.replace(/\.[^/.]+$/, '') + '_trimmed.mp4';
            const dummyText = `Video trimmed from ${startTime}s to ${endTime}s\nDuration: ${endTime-startTime}s\nOriginal: ${currentFile.name}`;
            const blob = new Blob([dummyText], { type: 'text/plain' });
            
            showResult('trimmer', blob, newFilename);
            showProgress('trimmer', false);
        }
        
        // ========================================
        // AUDIO EXTRACTOR - SIMULASI
        // ========================================
        async function extractAudio() {
            if (!currentFile) return;
            
            showProgress('extractor');
            updateProgress('extractor', 10, 'Mengekstrak audio...');
            
            // Simulasi proses
            await simulateProcess('extractor', 1800);
            
            // Buat file dummy untuk demo
            const newFilename = currentFile.name.replace(/\.[^/.]+$/, '') + '.mp3';
            const dummyText = `Audio extracted from: ${currentFile.name}\nQuality: ${document.getElementById('extractorQuality').value}kbps`;
            const blob = new Blob([dummyText], { type: 'text/plain' });
            
            showResult('extractor', blob, newFilename);
            showProgress('extractor', false);
        }
        
        // ========================================
        // FILE COMPRESSOR - SIMULASI
        // ========================================
        async function compressFile() {
            if (!currentFile) return;
            
            const level = document.getElementById('compressorLevel').value;
            
            showProgress('compressor');
            updateProgress('compressor', 10, 'Mengkompres file...');
            
            // Simulasi proses
            await simulateProcess('compressor', 1500);
            
            // Buat file dummy untuk demo
            const newFilename = currentFile.name.replace(/\.[^/.]+$/, '') + '_compressed.' + currentFile.name.split('.').pop();
            const dummyText = `File compressed (${level} level)\nOriginal: ${currentFile.name}\nCompression: 40% smaller`;
            const blob = new Blob([dummyText], { type: 'text/plain' });
            
            showResult('compressor', blob, newFilename);
            showProgress('compressor', false);
        }
        
        // ========================================
        // SIMULASI PROSES UNTUK DEMO
        // ========================================
        async function simulateProcess(toolName, duration = 2000) {
            return new Promise(resolve => {
                let progress = 10;
                const interval = setInterval(() => {
                    progress += Math.random() * 15;
                    if (progress > 95) progress = 95;
                    updateProgress(toolName, progress, getRandomProcessText(toolName));
                }, 300);
                
                setTimeout(() => {
                    clearInterval(interval);
                    updateProgress(toolName, 100, 'Selesai!');
                    resolve();
                }, duration);
            });
        }
        
        function getRandomProcessText(toolName) {
            const texts = {
                converter: ['Converting format...', 'Processing codec...', 'Optimizing output...', 'Finalizing...'],
                trimmer: ['Trimming video...', 'Processing frames...', 'Encoding output...', 'Finalizing...'],
                extractor: ['Extracting audio...', 'Processing audio stream...', 'Encoding MP3...', 'Finalizing...'],
                compressor: ['Compressing data...', 'Optimizing quality...', 'Reducing file size...', 'Finalizing...']
            };
            
            const toolTexts = texts[toolName] || ['Processing...', 'Working...', 'Almost done...'];
            return toolTexts[Math.floor(Math.random() * toolTexts.length)];
        }
        
        // ========================================
        // IMAGE UPSCALER - VERSI SEDERHANA
        // ========================================
        let upscalerImage = null;
        let upscaledBlob = null;
        
        function setupUpscalerInput() {
            setupFileInput('upscaler');
        }
        
        async function upscaleImage() {
            if (!currentFile) return;
            
            const scale = parseInt(document.getElementById('upscalerScale').value);
            const processBtn = document.getElementById('upscalerProcessBtn');
            const canvas = document.getElementById('upscalerResult');
            const placeholder = document.getElementById('upscalerPlaceholder');
            
            if (!canvas || !placeholder) return;
            
            try {
                processBtn.disabled = true;
                processBtn.textContent = `â³ Processing ${scale}x...`;
                showProgress('upscaler');
                updateProgress('upscaler', 10, 'Loading image...');
                
                // Load image
                const img = new Image();
                const imageUrl = URL.createObjectURL(currentFile);
                
                await new Promise((resolve, reject) => {
                    img.onload = resolve;
                    img.onerror = reject;
                    img.src = imageUrl;
                });
                
                updateProgress('upscaler', 30, 'Calculating new dimensions...');
                
                // Set canvas size to upscaled dimensions
                const newWidth = img.width * scale;
                const newHeight = img.height * scale;
                
                canvas.width = newWidth;
                canvas.height = newHeight;
                const ctx = canvas.getContext('2d');
                
                updateProgress('upscaler', 50, `Upscaling to ${newWidth}x${newHeight}...`);
                
                // Enable image smoothing for better quality
                ctx.imageSmoothingEnabled = true;
                ctx.imageSmoothingQuality = 'high';
                
                // Draw upscaled image
                ctx.drawImage(img, 0, 0, newWidth, newHeight);
                
                updateProgress('upscaler', 80, 'Applying enhancement...');
                
                // Simple sharpening
                sharpenImage(ctx, canvas.width, canvas.height);
                
                updateProgress('upscaler', 90, 'Finalizing...');
                
                // Convert to blob
                canvas.toBlob((blob) => {
                    upscaledBlob = blob;
                    updateProgress('upscaler', 100, 'Complete!');
                    
                    setTimeout(() => {
                        showProgress('upscaler', false);
                        placeholder.style.display = 'none';
                        canvas.style.display = 'block';
                        
                        // Tampilkan tombol download
                        const downloadBtn = document.getElementById('upscalerDownloadBtn');
                        if (downloadBtn) downloadBtn.style.display = 'block';
                        
                        processBtn.disabled = false;
                        processBtn.textContent = 'âœ¨ Upscale Sekarang';
                        
                        // Show result size
                        const resultSize = document.getElementById('upscalerResultSize');
                        if (resultSize) {
                            resultSize.textContent = `${newWidth} x ${newHeight} px (${scale}x upscaled)`;
                        }
                    }, 500);
                }, 'image/png', 1.0);
                
                URL.revokeObjectURL(imageUrl);
                
            } catch (error) {
                console.error('Upscaling error:', error);
                showProgress('upscaler', false);
                showError('upscaler', 'Gagal upscale gambar: ' + error.message);
                processBtn.disabled = false;
                processBtn.textContent = 'âœ¨ Upscale Sekarang';
            }
        }
        
        function sharpenImage(ctx, width, height) {
            const imageData = ctx.getImageData(0, 0, width, height);
            const data = imageData.data;
            
            // Simple sharpening kernel
            for (let y = 1; y < height - 1; y++) {
                for (let x = 1; x < width - 1; x++) {
                    for (let c = 0; c < 3; c++) {
                        const idx = (y * width + x) * 4 + c;
                        
                        // Apply simple sharpening
                        const sharpen = 
                            -0.5 * data[idx - width * 4 + c] +
                            -0.5 * data[idx - 4 + c] +
                            3.0 * data[idx] +
                            -0.5 * data[idx + 4 + c] +
                            -0.5 * data[idx + width * 4 + c];
                        
                        data[idx] = Math.max(0, Math.min(255, sharpen));
                    }
                }
            }
            
            ctx.putImageData(imageData, 0, 0);
        }
        
        function downloadUpscaled() {
            if (!upscaledBlob) return;
            
            const scale = document.getElementById('upscalerScale').value;
            const url = URL.createObjectURL(upscaledBlob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `upscaled-${scale}x-artzzy.png`;
            a.click();
            URL.revokeObjectURL(url);
        }
        
        // ========================================
        // BACKGROUND REMOVER - VERSI SEDERHANA
        // ========================================
        let bgRemovedBlob = null;
        
        function setupBgRemoverInput() {
            setupFileInput('bgremover');
        }
        
        async function processBackgroundRemoval() {
            if (!currentFile) return;
            
            const processBtn = document.getElementById('bgremoverProcessBtn');
            const canvas = document.getElementById('bgremoverResult');
            
            if (!canvas) return;
            
            try {
                processBtn.disabled = true;
                processBtn.textContent = 'â³ Processing...';
                showProgress('bgremover');
                updateProgress('bgremover', 10, 'Loading image...');
                
                // Load image
                const img = new Image();
                const imageUrl = URL.createObjectURL(currentFile);
                
                await new Promise((resolve, reject) => {
                    img.onload = resolve;
                    img.onerror = reject;
                    img.src = imageUrl;
                });
                
                updateProgress('bgremover', 30, 'Detecting edges...');
                
                // Set canvas size
                canvas.width = img.width;
                canvas.height = img.height;
                const ctx = canvas.getContext('2d');
                
                // Draw original image
                ctx.drawImage(img, 0, 0);
                
                updateProgress('bgremover', 60, 'Removing background...');
                
                // Get image data
                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                const data = imageData.data;
                
                // Simple background removal (edge detection based)
                removeBackgroundSimple(data, canvas.width, canvas.height);
                
                updateProgress('bgremover', 90, 'Finalizing...');
                
                ctx.putImageData(imageData, 0, 0);
                
                // Convert to blob
                canvas.toBlob((blob) => {
                    bgRemovedBlob = blob;
                    updateProgress('bgremover', 100, 'Complete!');
                    
                    setTimeout(() => {
                        showProgress('bgremover', false);
                        
                        // Tampilkan tombol download
                        const downloadBtn = document.getElementById('bgremoverDownloadBtn');
                        if (downloadBtn) downloadBtn.style.display = 'block';
                        
                        processBtn.disabled = false;
                        processBtn.textContent = 'âœ¨ Remove Background';
                    }, 500);
                }, 'image/png');
                
                URL.revokeObjectURL(imageUrl);
                
            } catch (error) {
                console.error('Background removal error:', error);
                showProgress('bgremover', false);
                showError('bgremover', 'Gagal remove background: ' + error.message);
                processBtn.disabled = false;
                processBtn.textContent = 'âœ¨ Remove Background';
            }
        }
        
        function removeBackgroundSimple(data, width, height) {
            // Simple algorithm: remove edges and similar colors
            for (let i = 0; i < data.length; i += 4) {
                const r = data[i];
                const g = data[i + 1];
                const b = data[i + 2];
                
                // Calculate brightness
                const brightness = (r + g + b) / 3;
                
                // Detect edges (simple Sobel-like)
                const x = (i / 4) % width;
                const y = Math.floor((i / 4) / width);
                
                if (x > 0 && x < width - 1 && y > 0 && y < height - 1) {
                    // Sample edge detection
                    let edgeScore = 0;
                    for (let dy = -1; dy <= 1; dy++) {
                        for (let dx = -1; dx <= 1; dx++) {
                            const ni = ((y + dy) * width + (x + dx)) * 4;
                            const diff = Math.abs(data[i] - data[ni]) + 
                                       Math.abs(data[i+1] - data[ni+1]) + 
                                       Math.abs(data[i+2] - data[ni+2]);
                            edgeScore += diff;
                        }
                    }
                    
                    // If low edge score and bright area, make transparent (background)
                    if (edgeScore < 100 && brightness > 180) {
                        data[i + 3] = 0; // Transparent
                    }
                }
            }
        }
        
        function downloadBgRemoved() {
            if (!bgRemovedBlob) return;
            
            const url = URL.createObjectURL(bgRemovedBlob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'no-background-artzzy.png';
            a.click();
            URL.revokeObjectURL(url);
        }
        
        // ========================================
        // VERCEL DEPLOYER - SIMULASI
        // ========================================
        function setupDeployerInput() {
            const fileInput = document.getElementById('deployerFile');
            const uploadZone = document.getElementById('deployerUpload');
            const nameInput = document.getElementById('deployerName');
            
            // Update preview URL on name change
            nameInput.addEventListener('input', (e) => {
                const name = e.target.value.toLowerCase().replace(/[^a-z0-9-]/g, '');
                nameInput.value = name;
                const previewUrl = document.getElementById('deployerPreviewUrl');
                if (previewUrl) {
                    previewUrl.textContent = name ? `${name}.vercel.app` : 'my-awesome-site.vercel.app';
                }
                checkDeployerReady();
            });
            
            setupFileInput('deployer');
        }
        
        function checkDeployerReady() {
            const name = document.getElementById('deployerName').value.trim();
            const btn = document.getElementById('deployerBtn');
            const fileInput = document.getElementById('deployerFile');
            
            btn.disabled = !(name && fileInput.files.length > 0);
        }
        
        async function deployToVercel() {
            const projectName = document.getElementById('deployerName').value.trim();
            const fileInput = document.getElementById('deployerFile');
            
            if (!projectName || !fileInput.files.length) {
                showError('deployer', 'Lengkapi nama website dan upload file terlebih dahulu');
                return;
            }
            
            const btn = document.getElementById('deployerBtn');
            const result = document.getElementById('deployerResult');
            
            try {
                btn.disabled = true;
                btn.textContent = 'â³ Deploying...';
                if (result) result.classList.remove('active');
                showProgress('deployer');
                updateProgress('deployer', 10, 'Mempersiapkan deployment...');
                
                // Simulasi proses
                await simulateDeployProcess();
                
                updateProgress('deployer', 100, 'Deploy berhasil!');
                
                setTimeout(() => {
                    showProgress('deployer', false);
                    
                    // Show result (simulasi)
                    const deploymentUrl = `https://${projectName}.vercel.app`;
                    const resultUrl = document.getElementById('deployerResultUrl');
                    if (resultUrl) {
                        resultUrl.href = deploymentUrl;
                        resultUrl.textContent = deploymentUrl;
                    }
                    if (result) result.classList.add('active');
                    
                    btn.disabled = false;
                    btn.textContent = 'ðŸš€ Deploy ke Vercel';
                }, 500);
                
            } catch (error) {
                console.error('Deployment error:', error);
                showProgress('deployer', false);
                showError('deployer', 'Deployment gagal: ' + error.message);
                btn.disabled = false;
                btn.textContent = 'ðŸš€ Deploy ke Vercel';
            }
        }
        
        async function simulateDeployProcess() {
            return new Promise(resolve => {
                const steps = [
                    [20, 'Uploading files...'],
                    [40, 'Creating project...'],
                    [60, 'Configuring settings...'],
                    [80, 'Deploying to CDN...'],
                    [95, 'Finalizing...']
                ];
                
                let step = 0;
                const interval = setInterval(() => {
                    if (step < steps.length) {
                        updateProgress('deployer', steps[step][0], steps[step][1]);
                        step++;
                    }
                }, 800);
                
                setTimeout(() => {
                    clearInterval(interval);
                    resolve();
                }, 4000);
            });
        }
        
        function copyDeployUrl() {
            const urlElement = document.getElementById('deployerResultUrl');
            if (!urlElement) return;
            
            const url = urlElement.href;
            navigator.clipboard.writeText(url).then(() => {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = 'âœ… Copied!';
                setTimeout(() => {
                    btn.textContent = originalText;
                }, 2000);
            });
        }
        
        // ========================================
        // CODE SCREENSHOT GENERATOR
        // ========================================
        let html2canvasLoaded = false;
        
        async function loadHTML2Canvas() {
            if (html2canvasLoaded) return;
            
            // HTML2Canvas sudah di-load di head
            html2canvasLoaded = true;
        }
        
        function generateCodeImage() {
            const code = document.getElementById('carbonCode').value;
            const language = document.getElementById('carbonLanguage').value;
            const theme = document.getElementById('carbonTheme').value;
            const fontSize = document.getElementById('carbonFontSize').value;
            
            if (!code.trim()) {
                showError('carbon', 'Silakan masukkan code terlebih dahulu!');
                return;
            }
            
            const canvasContainer = document.getElementById('carbonCanvas');
            const codeContent = document.getElementById('carbonCodeContent');
            const preview = document.getElementById('carbonPreview');
            
            if (!canvasContainer || !codeContent || !preview) return;
            
            // Apply theme
            const themes = {
                ocean: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                sunset: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
                forest: 'linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)',
                purple: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',
                dark: 'linear-gradient(135deg, #232526 0%, #414345 100%)',
                light: 'linear-gradient(135deg, #e0e0e0 0%, #f5f5f5 100%)'
            };
            
            canvasContainer.style.background = themes[theme] || themes.ocean;
            
            // Apply font size
            codeContent.style.fontSize = fontSize + 'px';
            
            // Apply syntax highlighting
            const highlightedCode = highlightSyntax(code, language);
            codeContent.innerHTML = highlightedCode;
            
            // Show preview
            preview.style.display = 'block';
            
            // Scroll to preview
            preview.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
        
        function highlightSyntax(code, language) {
            // ... (fungsi highlightSyntax Anda tetap sama)
            // Salin dari kode asli Anda
            const keywords = {
                javascript: ['const', 'let', 'var', 'function', 'return', 'if', 'else', 'for', 'while', 'class', 'new', 'this', 'import', 'export', 'from', 'async', 'await', 'try', 'catch', 'throw', 'switch', 'case', 'break', 'continue', 'default', 'typeof', 'instanceof'],
                python: ['def', 'class', 'if', 'elif', 'else', 'for', 'while', 'return', 'import', 'from', 'as', 'try', 'except', 'finally', 'with', 'lambda', 'yield', 'pass', 'break', 'continue', 'and', 'or', 'not', 'in', 'is', 'True', 'False', 'None'],
                java: ['public', 'private', 'protected', 'class', 'interface', 'extends', 'implements', 'new', 'return', 'if', 'else', 'for', 'while', 'switch', 'case', 'break', 'continue', 'try', 'catch', 'finally', 'throw', 'throws', 'static', 'final', 'void', 'int', 'String', 'boolean', 'double', 'float'],
                cpp: ['include', 'using', 'namespace', 'class', 'public', 'private', 'protected', 'int', 'void', 'return', 'if', 'else', 'for', 'while', 'switch', 'case', 'break', 'continue', 'new', 'delete', 'const', 'auto', 'template', 'typename'],
                csharp: ['using', 'namespace', 'class', 'public', 'private', 'protected', 'static', 'void', 'int', 'string', 'bool', 'return', 'if', 'else', 'for', 'foreach', 'while', 'switch', 'case', 'break', 'continue', 'new', 'var', 'async', 'await'],
                php: ['function', 'class', 'public', 'private', 'protected', 'return', 'if', 'else', 'elseif', 'for', 'foreach', 'while', 'switch', 'case', 'break', 'continue', 'new', 'echo', 'require', 'include', 'namespace', 'use'],
                ruby: ['def', 'class', 'module', 'if', 'elsif', 'else', 'unless', 'for', 'while', 'until', 'return', 'yield', 'begin', 'rescue', 'ensure', 'end', 'do', 'case', 'when', 'break', 'next'],
                go: ['package', 'import', 'func', 'var', 'const', 'type', 'struct', 'interface', 'return', 'if', 'else', 'for', 'switch', 'case', 'break', 'continue', 'go', 'defer', 'range', 'map', 'chan'],
                rust: ['fn', 'let', 'mut', 'const', 'struct', 'enum', 'impl', 'trait', 'pub', 'use', 'mod', 'return', 'if', 'else', 'for', 'while', 'loop', 'match', 'break', 'continue'],
                html: ['html', 'head', 'body', 'div', 'span', 'p', 'a', 'img', 'ul', 'li', 'table', 'tr', 'td', 'form', 'input', 'button', 'script', 'style', 'link', 'meta'],
                css: ['color', 'background', 'margin', 'padding', 'border', 'width', 'height', 'display', 'flex', 'grid', 'position', 'font', 'text', 'align', 'hover', 'active', 'before', 'after'],
                sql: ['SELECT', 'FROM', 'WHERE', 'INSERT', 'UPDATE', 'DELETE', 'CREATE', 'TABLE', 'DROP', 'ALTER', 'JOIN', 'INNER', 'LEFT', 'RIGHT', 'ON', 'AND', 'OR', 'ORDER', 'BY', 'GROUP', 'HAVING', 'LIMIT']
            };
            
            const langKeywords = keywords[language] || keywords.javascript;
            
            // Escape HTML
            let highlighted = code
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;');
            
            // Highlight strings
            highlighted = highlighted.replace(/(["'`])(?:(?=(\\?))\2.)*?\1/g, '<span class="string">$&</span>');
            
            // Highlight comments
            highlighted = highlighted.replace(/(\/\/.*$|\/\*[\s\S]*?\*\/|#.*$)/gm, '<span class="comment">$&</span>');
            
            // Highlight numbers
            highlighted = highlighted.replace(/\b(\d+\.?\d*)\b/g, '<span class="number">$1</span>');
            
            // Highlight keywords
            langKeywords.forEach(keyword => {
                const regex = new RegExp(`\\b(${keyword})\\b`, 'g');
                highlighted = highlighted.replace(regex, '<span class="keyword">$1</span>');
            });
            
            // Highlight functions
            highlighted = highlighted.replace(/\b([a-zA-Z_][a-zA-Z0-9_]*)\s*(?=\()/g, '<span class="function">$1</span>');
            
            // Add line numbers
            const lines = highlighted.split('\n');
            const numberedLines = lines.map((line, index) => {
                const lineNum = `<span style="color: #6272a4; margin-right: 1.5rem; user-select: none; display: inline-block; width: 2rem; text-align: right;">${index + 1}</span>`;
                return `<span class="code-line">${lineNum}${line || ' '}</span>`;
            });
            
            return numberedLines.join('\n');
        }
        
        async function downloadCodeImage() {
            const canvasContainer = document.getElementById('carbonCanvas');
            
            try {
                if (typeof html2canvas === 'undefined') {
                    await loadHTML2Canvas();
                }
                
                const canvas = await html2canvas(canvasContainer, {
                    backgroundColor: null,
                    scale: 2,
                    logging: false
                });
                
                canvas.toBlob((blob) => {
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'code-screenshot-artzzy.png';
                    a.click();
                    URL.revokeObjectURL(url);
                });
                
            } catch (error) {
                console.error('Download error:', error);
                showError('carbon', 'Gagal download screenshot. Coba screenshot manual.');
            }
        }
        
        // ========================================
        // INITIALIZE ALL FILE INPUTS
        // ========================================
        document.addEventListener('DOMContentLoaded', function() {
            // Setup semua file inputs
            ['converter', 'trimmer', 'extractor', 'compressor', 'bgremover', 'upscaler', 'deployer'].forEach(tool => {
                setupFileInput(tool);
            });
            
            // Setup khusus untuk tools tertentu
            setupDeployerInput();
            
            console.log('Media Converter Pro initialized!');
        });
    </script>
</body>
</html>