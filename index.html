<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Media Converter Pro</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=JetBrains+Mono:wght@400;500&display=swap');
        
        :root {
            --bg-dark: #0a0e27;
            --bg-card: #141937;
            --accent-primary: #00d9ff;
            --accent-secondary: #7c3aed;
            --accent-gradient: linear-gradient(135deg, #00d9ff 0%, #7c3aed 100%);
            --text-primary: #ffffff;
            --text-secondary: #94a3b8;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --border: rgba(255, 255, 255, 0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle at 30% 20%, rgba(0, 217, 255, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 70% 80%, rgba(124, 58, 237, 0.1) 0%, transparent 50%);
            animation: gradientShift 15s ease infinite;
            pointer-events: none;
            z-index: 0;
        }
        
        /* Welcome Landing Page */
        .welcome-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            background: var(--bg-dark);
            transition: opacity 0.8s ease, transform 0.8s ease;
        }
        
        .welcome-screen.hidden {
            opacity: 0;
            transform: scale(0.95);
            pointer-events: none;
        }
        
        .welcome-content {
            text-align: center;
            max-width: 700px;
            padding: 2rem;
            animation: welcomeFadeIn 1s ease;
        }
        
        .welcome-logo {
            font-size: 5rem;
            margin-bottom: 1rem;
            animation: bounce 2s ease infinite;
        }
        
        .welcome-title {
            font-size: clamp(2.5rem, 6vw, 4.5rem);
            font-weight: 700;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
            letter-spacing: -0.02em;
            line-height: 1.2;
        }
        
        .welcome-subtitle {
            font-size: clamp(1rem, 2vw, 1.3rem);
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            font-weight: 300;
        }
        
        .welcome-creator {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 3rem;
            opacity: 0.8;
        }
        
        .welcome-creator span {
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 600;
        }
        
        .start-btn {
            background: var(--accent-gradient);
            border: none;
            color: white;
            padding: 1.25rem 3rem;
            border-radius: 3rem;
            font-family: 'Outfit', sans-serif;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0, 217, 255, 0.3);
            animation: pulse 2s ease infinite;
        }
        
        .start-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .start-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 20px 60px rgba(0, 217, 255, 0.5);
        }
        
        .start-btn:hover::before {
            width: 300px;
            height: 300px;
        }
        
        .start-btn:active {
            transform: translateY(-2px) scale(1.02);
        }
        
        .features-preview {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 3rem;
            animation: welcomeFadeIn 1.2s ease backwards;
            animation-delay: 0.3s;
        }
        
        .feature-badge {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border);
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .feature-badge:hover {
            background: rgba(0, 217, 255, 0.1);
            border-color: var(--accent-primary);
            color: var(--text-primary);
            transform: translateY(-2px);
        }
        
        @keyframes welcomeFadeIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-20px);
            }
        }
        
        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 10px 40px rgba(0, 217, 255, 0.3);
            }
            50% {
                box-shadow: 0 10px 60px rgba(0, 217, 255, 0.5);
            }
        }
        
        .main-content {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease, transform 0.8s ease;
        }
        
        .main-content.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        @keyframes gradientShift {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(5%, 5%) rotate(5deg); }
        }
        
        .container {
            position: relative;
            z-index: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        
        header {
            text-align: center;
            margin-bottom: 3rem;
            animation: fadeInDown 0.8s ease;
        }
        
        h1 {
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: 700;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
            letter-spacing: -0.02em;
        }
        
        .subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
            font-weight: 300;
        }
        
        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .tool-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 1.5rem;
            padding: 2rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.8s ease backwards;
        }
        
        .tool-card:nth-child(1) { animation-delay: 0.1s; }
        .tool-card:nth-child(2) { animation-delay: 0.2s; }
        .tool-card:nth-child(3) { animation-delay: 0.3s; }
        .tool-card:nth-child(4) { animation-delay: 0.4s; }
        .tool-card:nth-child(5) { animation-delay: 0.5s; }
        .tool-card:nth-child(6) { animation-delay: 0.6s; }
        .tool-card:nth-child(7) { animation-delay: 0.7s; }
        .tool-card:nth-child(8) { animation-delay: 0.8s; }
        
        .tool-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--accent-gradient);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .tool-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent-primary);
            box-shadow: 0 20px 40px rgba(0, 217, 255, 0.2);
        }
        
        .tool-card:hover::before {
            transform: scaleX(1);
        }
        
        .tool-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            display: block;
        }
        
        .tool-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .tool-desc {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.5;
        }
        
        .workspace {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 1.5rem;
            padding: 2.5rem;
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .workspace.active {
            display: block;
        }
        
        .workspace-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }
        
        .workspace-title {
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        .back-btn {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Outfit', sans-serif;
            font-size: 0.95rem;
        }
        
        .back-btn:hover {
            border-color: var(--accent-primary);
            background: rgba(0, 217, 255, 0.1);
        }
        
        .upload-zone {
            border: 2px dashed var(--border);
            border-radius: 1rem;
            padding: 3rem 2rem;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            margin-bottom: 2rem;
            background: rgba(255, 255, 255, 0.02);
        }
        
        .upload-zone:hover,
        .upload-zone.drag-over {
            border-color: var(--accent-primary);
            background: rgba(0, 217, 255, 0.05);
        }
        
        .upload-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }
        
        .upload-text {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }
        
        .upload-hint {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        input[type="file"] {
            display: none;
        }
        
        .controls {
            display: grid;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        label {
            font-weight: 500;
            color: var(--text-secondary);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        select, input[type="range"] {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            font-family: 'Outfit', sans-serif;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        select:focus, input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(0, 217, 255, 0.1);
        }
        
        select option {
            background: var(--bg-card);
            color: var(--text-primary);
        }
        
        .action-btn {
            background: var(--accent-gradient);
            border: none;
            color: white;
            padding: 1rem 2rem;
            border-radius: 0.75rem;
            font-family: 'Outfit', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .action-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            transition: left 0.3s ease;
        }
        
        .action-btn:hover::before {
            left: 100%;
        }
        
        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 217, 255, 0.3);
        }
        
        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .progress-container {
            display: none;
            margin-top: 2rem;
        }
        
        .progress-container.active {
            display: block;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            overflow: hidden;
            margin-bottom: 1rem;
        }
        
        .progress-fill {
            height: 100%;
            background: var(--accent-gradient);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 1rem;
        }
        
        .progress-text {
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .result-container {
            display: none;
            margin-top: 2rem;
            padding: 1.5rem;
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid var(--success);
            border-radius: 1rem;
        }
        
        .result-container.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .result-info {
            margin-bottom: 1rem;
        }
        
        .download-btn {
            background: var(--success);
            border: none;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-family: 'Outfit', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.3);
        }
        
        .file-info {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 0.75rem;
            padding: 1rem;
            margin-bottom: 1.5rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
        }
        
        .file-info-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }
        
        .file-info-row:last-child {
            margin-bottom: 0;
        }
        
        .file-info-label {
            color: var(--text-secondary);
        }
        
        .file-info-value {
            color: var(--accent-primary);
            font-weight: 500;
        }
        
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .error-message {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid var(--error);
            color: var(--error);
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
            display: none;
        }
        
        .error-message.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @media (max-width: 768px) {
            .tools-grid {
                grid-template-columns: 1fr;
            }
            
            .workspace {
                padding: 1.5rem;
            }
            
            .upload-zone {
                padding: 2rem 1rem;
            }
        }
        
        /* Syntax Highlighting Styles */
        .code-line { display: block; }
        .keyword { color: #ff79c6; font-weight: 600; }
        .function { color: #50fa7b; font-weight: 500; }
        .string { color: #f1fa8c; }
        .number { color: #bd93f9; }
        .comment { color: #6272a4; font-style: italic; }
        .operator { color: #ff79c6; }
        .variable { color: #8be9fd; }
        .class-name { color: #50fa7b; font-weight: 600; }
        .property { color: #66d9ef; }
        .punctuation { color: #f8f8f2; }
        .builtin { color: #8be9fd; font-weight: 500; }
        
        #carbonCodeContent {
            color: #f8f8f2;
            line-height: 1.6;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>
    <!-- Welcome Landing Page -->
    <div class="welcome-screen" id="welcomeScreen">
        <div class="welcome-content">
            <div class="welcome-logo">üé®</div>
            <h1 class="welcome-title">Selamat Datang di Media Converter Pro!</h1>
            <p class="welcome-subtitle">All-in-One Tools untuk Kebutuhan Media Anda</p>
            <p class="welcome-creator">Created by <span>Artzzy MXR3</span></p>
            
            <button class="start-btn" onclick="showTools()">
                ‚ú® Pilih Tools Sekarang
            </button>
            
            <div class="features-preview">
                <div class="feature-badge">
                    <span>üîÑ</span> Converter
                </div>
                <div class="feature-badge">
                    <span>‚úÇÔ∏è</span> Trimmer
                </div>
                <div class="feature-badge">
                    <span>üéµ</span> Audio Extract
                </div>
                <div class="feature-badge">
                    <span>üì¶</span> Compressor
                </div>
                <div class="feature-badge">
                    <span>üíª</span> Code Screenshot
                </div>
                <div class="feature-badge">
                    <span>üñºÔ∏è</span> BG Remover
                </div>
                <div class="feature-badge">
                    <span>üöÄ</span> Vercel Deploy
                </div>
                <div class="feature-badge">
                    <span>üîç</span> Image Upscaler
                </div>
            </div>
        </div>
    </div>
    
    <div class="container main-content" id="mainContent">
        <header>
            <h1>Media Converter Pro</h1>
            <p class="subtitle">Convert, Edit & Optimize Your Media Files</p>
            <p class="subtitle" style="margin-top: 0.5rem; font-size: 0.9rem; opacity: 0.7;">
                Created by <span style="background: var(--accent-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: 600;">Artzzy MXR3</span>
                <button onclick="backToWelcome()" style="background: transparent; border: 1px solid var(--border); color: var(--text-secondary); padding: 0.4rem 1rem; border-radius: 0.5rem; cursor: pointer; font-family: 'Outfit', sans-serif; font-size: 0.85rem; margin-left: 1rem; transition: all 0.3s ease;" onmouseover="this.style.borderColor='var(--accent-primary)'; this.style.color='var(--text-primary)';" onmouseout="this.style.borderColor='var(--border)'; this.style.color='var(--text-secondary)';">
                    üè† Home
                </button>
            </p>
        </header>
        
        <div id="toolsGrid" class="tools-grid">
            <div class="tool-card" onclick="openTool('converter')">
                <span class="tool-icon">üîÑ</span>
                <h3 class="tool-title">Format Converter</h3>
                <p class="tool-desc">Convert antara format audio dan video (MP4, MP3, WebM, WAV, dll)</p>
            </div>
            
            <div class="tool-card" onclick="openTool('trimmer')">
                <span class="tool-icon">‚úÇÔ∏è</span>
                <h3 class="tool-title">Video Trimmer</h3>
                <p class="tool-desc">Potong dan trim video dengan mudah</p>
            </div>
            
            <div class="tool-card" onclick="openTool('extractor')">
                <span class="tool-icon">üéµ</span>
                <h3 class="tool-title">Audio Extractor</h3>
                <p class="tool-desc">Ekstrak audio dari file video</p>
            </div>
            
            <div class="tool-card" onclick="openTool('compressor')">
                <span class="tool-icon">üì¶</span>
                <h3 class="tool-title">File Compressor</h3>
                <p class="tool-desc">Compress file untuk menghemat storage</p>
            </div>
            
            <div class="tool-card" onclick="openTool('carbon')">
                <span class="tool-icon">üíª</span>
                <h3 class="tool-title">Code Screenshot</h3>
                <p class="tool-desc">Generate beautiful code screenshots dengan style keren</p>
            </div>
            
            <div class="tool-card" onclick="openTool('bgremover')">
                <span class="tool-icon">üñºÔ∏è</span>
                <h3 class="tool-title">Background Remover</h3>
                <p class="tool-desc">Hapus background gambar secara otomatis dengan AI</p>
            </div>
            
            <div class="tool-card" onclick="openTool('deployer')">
                <span class="tool-icon">üöÄ</span>
                <h3 class="tool-title">Vercel Deployer</h3>
                <p class="tool-desc">Deploy website kamu ke Vercel dengan mudah</p>
            </div>
            
            <div class="tool-card" onclick="openTool('upscaler')">
                <span class="tool-icon">üîç</span>
                <h3 class="tool-title">Image Upscaler</h3>
                <p class="tool-desc">Tingkatkan resolusi gambar hingga Ultra HD 4K</p>
            </div>
        </div>
        
        <!-- Format Converter Workspace -->
        <div id="converter" class="workspace">
            <div class="workspace-header">
                <h2 class="workspace-title">Format Converter</h2>
                <button class="back-btn" onclick="closeTool()">‚Üê Kembali</button>
            </div>
            
            <div class="upload-zone" id="converterUpload" onclick="document.getElementById('converterFile').click()">
                <div class="upload-icon">üìÅ</div>
                <div class="upload-text">Klik atau drag file ke sini</div>
                <div class="upload-hint">Support: MP4, MP3, WebM, WAV, AVI, MKV, dll</div>
            </div>
            <input type="file" id="converterFile" accept="audio/*,video/*">
            
            <div class="file-info" id="converterFileInfo" style="display: none;"></div>
            
            <div class="controls">
                <div class="control-group">
                    <label>Output Format</label>
                    <select id="converterFormat">
                        <optgroup label="Video">
                            <option value="mp4">MP4</option>
                            <option value="webm">WebM</option>
                            <option value="avi">AVI</option>
                            <option value="mkv">MKV</option>
                        </optgroup>
                        <optgroup label="Audio">
                            <option value="mp3">MP3</option>
                            <option value="wav">WAV</option>
                            <option value="aac">AAC</option>
                            <option value="ogg">OGG</option>
                        </optgroup>
                    </select>
                </div>
                
                <button class="action-btn" id="converterBtn" onclick="convertFile()" disabled>
                    Convert File
                </button>
            </div>
            
            <div class="progress-container" id="converterProgress">
                <div class="progress-bar">
                    <div class="progress-fill" id="converterProgressBar"></div>
                </div>
                <div class="progress-text" id="converterProgressText">Processing...</div>
            </div>
            
            <div class="result-container" id="converterResult">
                <div class="result-info">‚úÖ Conversion berhasil!</div>
                <button class="download-btn" id="converterDownload">Download File</button>
            </div>
            
            <div class="error-message" id="converterError"></div>
        </div>
        
        <!-- Video Trimmer Workspace -->
        <div id="trimmer" class="workspace">
            <div class="workspace-header">
                <h2 class="workspace-title">Video Trimmer</h2>
                <button class="back-btn" onclick="closeTool()">‚Üê Kembali</button>
            </div>
            
            <div class="upload-zone" id="trimmerUpload" onclick="document.getElementById('trimmerFile').click()">
                <div class="upload-icon">üé¨</div>
                <div class="upload-text">Klik atau drag video ke sini</div>
                <div class="upload-hint">Support: MP4, WebM, AVI, MKV, dll</div>
            </div>
            <input type="file" id="trimmerFile" accept="video/*">
            
            <div class="file-info" id="trimmerFileInfo" style="display: none;"></div>
            
            <div class="controls">
                <div class="control-group">
                    <label>Start Time (detik)</label>
                    <input type="number" id="trimStart" value="0" min="0" step="0.1">
                </div>
                
                <div class="control-group">
                    <label>End Time (detik)</label>
                    <input type="number" id="trimEnd" value="10" min="0" step="0.1">
                </div>
                
                <button class="action-btn" id="trimmerBtn" onclick="trimVideo()" disabled>
                    Trim Video
                </button>
            </div>
            
            <div class="progress-container" id="trimmerProgress">
                <div class="progress-bar">
                    <div class="progress-fill" id="trimmerProgressBar"></div>
                </div>
                <div class="progress-text" id="trimmerProgressText">Processing...</div>
            </div>
            
            <div class="result-container" id="trimmerResult">
                <div class="result-info">‚úÖ Video berhasil di-trim!</div>
                <button class="download-btn" id="trimmerDownload">Download Video</button>
            </div>
            
            <div class="error-message" id="trimmerError"></div>
        </div>
        
        <!-- Audio Extractor Workspace -->
        <div id="extractor" class="workspace">
            <div class="workspace-header">
                <h2 class="workspace-title">Audio Extractor</h2>
                <button class="back-btn" onclick="closeTool()">‚Üê Kembali</button>
            </div>
            
            <div class="upload-zone" id="extractorUpload" onclick="document.getElementById('extractorFile').click()">
                <div class="upload-icon">üé•</div>
                <div class="upload-text">Klik atau drag video ke sini</div>
                <div class="upload-hint">Audio akan diekstrak dalam format MP3</div>
            </div>
            <input type="file" id="extractorFile" accept="video/*">
            
            <div class="file-info" id="extractorFileInfo" style="display: none;"></div>
            
            <div class="controls">
                <div class="control-group">
                    <label>Audio Quality</label>
                    <select id="extractorQuality">
                        <option value="128">Standard (128 kbps)</option>
                        <option value="192">Good (192 kbps)</option>
                        <option value="256" selected>High (256 kbps)</option>
                        <option value="320">Best (320 kbps)</option>
                    </select>
                </div>
                
                <button class="action-btn" id="extractorBtn" onclick="extractAudio()" disabled>
                    Extract Audio
                </button>
            </div>
            
            <div class="progress-container" id="extractorProgress">
                <div class="progress-bar">
                    <div class="progress-fill" id="extractorProgressBar"></div>
                </div>
                <div class="progress-text" id="extractorProgressText">Processing...</div>
            </div>
            
            <div class="result-container" id="extractorResult">
                <div class="result-info">‚úÖ Audio berhasil diekstrak!</div>
                <button class="download-btn" id="extractorDownload">Download Audio</button>
            </div>
            
            <div class="error-message" id="extractorError"></div>
        </div>
        
        <!-- File Compressor Workspace -->
        <div id="compressor" class="workspace">
            <div class="workspace-header">
                <h2 class="workspace-title">File Compressor</h2>
                <button class="back-btn" onclick="closeTool()">‚Üê Kembali</button>
            </div>
            
            <div class="upload-zone" id="compressorUpload" onclick="document.getElementById('compressorFile').click()">
                <div class="upload-icon">üì¶</div>
                <div class="upload-text">Klik atau drag file ke sini</div>
                <div class="upload-hint">Kompres video atau audio untuk menghemat storage</div>
            </div>
            <input type="file" id="compressorFile" accept="audio/*,video/*">
            
            <div class="file-info" id="compressorFileInfo" style="display: none;"></div>
            
            <div class="controls">
                <div class="control-group">
                    <label>Compression Level</label>
                    <select id="compressorLevel">
                        <option value="low">Low (quality tinggi, ukuran lebih besar)</option>
                        <option value="medium" selected>Medium (balanced)</option>
                        <option value="high">High (quality rendah, ukuran kecil)</option>
                    </select>
                </div>
                
                <button class="action-btn" id="compressorBtn" onclick="compressFile()" disabled>
                    Compress File
                </button>
            </div>
            
            <div class="progress-container" id="compressorProgress">
                <div class="progress-bar">
                    <div class="progress-fill" id="compressorProgressBar"></div>
                </div>
                <div class="progress-text" id="compressorProgressText">Processing...</div>
            </div>
            
            <div class="result-container" id="compressorResult">
                <div class="result-info">‚úÖ File berhasil dikompress!</div>
                <button class="download-btn" id="compressorDownload">Download File</button>
            </div>
            
            <div class="error-message" id="compressorError"></div>
        </div>
        
        <!-- Code Screenshot Generator Workspace -->
        <div id="carbon" class="workspace">
            <div class="workspace-header">
                <h2 class="workspace-title">Code Screenshot Generator</h2>
                <button class="back-btn" onclick="closeTool()">‚Üê Kembali</button>
            </div>
            
            <div class="controls" style="margin-bottom: 1.5rem;">
                <div class="control-group">
                    <label>Programming Language</label>
                    <select id="carbonLanguage">
                        <option value="javascript">JavaScript</option>
                        <option value="python">Python</option>
                        <option value="java">Java</option>
                        <option value="cpp">C++</option>
                        <option value="csharp">C#</option>
                        <option value="php">PHP</option>
                        <option value="ruby">Ruby</option>
                        <option value="go">Go</option>
                        <option value="rust">Rust</option>
                        <option value="html">HTML</option>
                        <option value="css">CSS</option>
                        <option value="sql">SQL</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label>Theme</label>
                    <select id="carbonTheme">
                        <option value="ocean">Ocean Blue</option>
                        <option value="sunset">Sunset Orange</option>
                        <option value="forest">Forest Green</option>
                        <option value="purple">Purple Dream</option>
                        <option value="dark">Dark Mode</option>
                        <option value="light">Light Mode</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label>Font Size</label>
                    <select id="carbonFontSize">
                        <option value="12">Small (12px)</option>
                        <option value="14">Medium (14px)</option>
                        <option value="16" selected>Large (16px)</option>
                        <option value="18">Extra Large (18px)</option>
                    </select>
                </div>
            </div>
            
            <div class="control-group" style="margin-bottom: 1.5rem;">
                <label>Your Code</label>
                <textarea id="carbonCode" style="width: 100%; min-height: 200px; background: rgba(255,255,255,0.05); border: 1px solid var(--border); color: var(--text-primary); padding: 1rem; border-radius: 0.5rem; font-family: 'JetBrains Mono', monospace; font-size: 14px; resize: vertical;" placeholder="Paste your code here...">// Example code
function greet(name) {
    return `Hello, ${name}!`;
}

console.log(greet('World'));</textarea>
            </div>
            
            <button class="action-btn" onclick="generateCodeImage()" style="margin-bottom: 2rem;">
                üé® Generate Screenshot
            </button>
            
            <div id="carbonPreview" style="display: none;">
                <label style="display: block; margin-bottom: 0.5rem;">Preview</label>
                <div id="carbonCanvas" style="padding: 3rem; border-radius: 1rem; margin-bottom: 1rem; position: relative; overflow: hidden;">
                    <div style="position: absolute; top: 1rem; left: 1.5rem; display: flex; gap: 0.5rem; z-index: 10;">
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #ff5f56;"></div>
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #ffbd2e;"></div>
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #27c93f;"></div>
                    </div>
                    <pre id="carbonCodeDisplay" style="margin: 0; padding: 2.5rem 1.5rem 1.5rem; background: rgba(0,0,0,0.3); border-radius: 0.75rem; overflow-x: auto; position: relative; z-index: 1;"><code id="carbonCodeContent"></code></pre>
                </div>
                <button class="download-btn" onclick="downloadCodeImage()">üíæ Download Screenshot</button>
            </div>
            
            <div class="error-message" id="carbonError"></div>
        </div>
        
        <!-- Background Remover Workspace -->
        <div id="bgremover" class="workspace">
            <div class="workspace-header">
                <h2 class="workspace-title">Background Remover</h2>
                <button class="back-btn" onclick="closeTool()">‚Üê Kembali</button>
            </div>
            
            <div class="upload-zone" id="bgremoverUpload" onclick="document.getElementById('bgremoverFile').click()">
                <div class="upload-icon">üñºÔ∏è</div>
                <div class="upload-text">Klik atau drag gambar ke sini</div>
                <div class="upload-hint">Support: JPG, PNG, WebP (max 10MB)</div>
            </div>
            <input type="file" id="bgremoverFile" accept="image/*">
            
            <div id="bgremoverPreview" style="display: none; margin-bottom: 2rem;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem;">
                    <div>
                        <label style="display: block; margin-bottom: 0.5rem;">Original</label>
                        <div style="background: rgba(255,255,255,0.05); border-radius: 0.75rem; padding: 1rem; border: 1px solid var(--border);">
                            <img id="bgremoverOriginal" style="width: 100%; height: auto; border-radius: 0.5rem; display: block;">
                        </div>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 0.5rem;">No Background</label>
                        <div style="background: linear-gradient(45deg, #808080 25%, transparent 25%), linear-gradient(-45deg, #808080 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #808080 75%), linear-gradient(-45deg, transparent 75%, #808080 75%); background-size: 20px 20px; background-position: 0 0, 0 10px, 10px -10px, -10px 0px; border-radius: 0.75rem; padding: 1rem; border: 1px solid var(--border);">
                            <canvas id="bgremoverResult" style="width: 100%; height: auto; border-radius: 0.5rem; display: block;"></canvas>
                        </div>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <button class="action-btn" onclick="processBackgroundRemoval()" id="bgremoverProcessBtn">
                        ‚ú® Remove Background
                    </button>
                    <button class="download-btn" onclick="downloadBgRemoved()" id="bgremoverDownloadBtn" style="display: none;">
                        üíæ Download PNG
                    </button>
                </div>
            </div>
            
            <div class="progress-container" id="bgremoverProgress">
                <div class="progress-bar">
                    <div class="progress-fill" id="bgremoverProgressBar"></div>
                </div>
                <div class="progress-text" id="bgremoverProgressText">Processing with AI...</div>
            </div>
            
            <div class="error-message" id="bgremoverError"></div>
            
            <div style="margin-top: 2rem; padding: 1rem; background: rgba(255,255,255,0.03); border-radius: 0.75rem; border: 1px solid var(--border);">
                <p style="color: var(--text-secondary); font-size: 0.9rem; margin: 0;">
                    üí° <strong>Tips:</strong> Hasil terbaik dengan foto yang memiliki subjek jelas dan kontras bagus dengan background.
                </p>
            </div>
        </div>
        
        <!-- Vercel Deployer Workspace -->
        <div id="deployer" class="workspace">
            <div class="workspace-header">
                <h2 class="workspace-title">Vercel Deployer</h2>
                <button class="back-btn" onclick="closeTool()">‚Üê Kembali</button>
            </div>
            
            <div style="background: rgba(0, 217, 255, 0.1); border: 1px solid var(--accent-primary); border-radius: 0.75rem; padding: 1rem; margin-bottom: 2rem;">
                <p style="color: var(--accent-primary); font-size: 0.95rem; margin: 0;">
                    ‚ú® <strong>Siap Deploy!</strong> Tinggal masukkan nama website dan upload file, langsung online!
                </p>
            </div>
            
            <div class="controls">
                <div class="control-group">
                    <label>Nama Website</label>
                    <input type="text" id="deployerName" placeholder="my-awesome-site" style="width: 100%; background: rgba(255,255,255,0.05); border: 1px solid var(--border); color: var(--text-primary); padding: 0.75rem 1rem; border-radius: 0.5rem; font-family: 'Outfit', sans-serif; font-size: 1rem;">
                    <small style="color: var(--text-secondary); font-size: 0.85rem; margin-top: 0.25rem; display: block;">Akan menjadi: <span id="deployerPreviewUrl" style="color: var(--accent-primary);">my-awesome-site.vercel.app</span></small>
                </div>
            </div>
            
            <div class="upload-zone" id="deployerUpload" onclick="document.getElementById('deployerFile').click()" style="margin-bottom: 2rem;">
                <div class="upload-icon">üì¶</div>
                <div class="upload-text">Upload File Website</div>
                <div class="upload-hint">HTML tunggal atau ZIP yang berisi website lengkap</div>
            </div>
            <input type="file" id="deployerFile" accept=".html,.zip">
            
            <div class="file-info" id="deployerFileInfo" style="display: none;"></div>
            
            <button class="action-btn" onclick="deployToVercel()" id="deployerBtn" disabled style="width: 100%; margin-bottom: 1.5rem;">
                üöÄ Deploy ke Vercel
            </button>
            
            <div class="progress-container" id="deployerProgress">
                <div class="progress-bar">
                    <div class="progress-fill" id="deployerProgressBar"></div>
                </div>
                <div class="progress-text" id="deployerProgressText">Deploying...</div>
            </div>
            
            <div class="result-container" id="deployerResult" style="background: rgba(16, 185, 129, 0.1); border: 1px solid var(--success);">
                <div style="margin-bottom: 1rem;">
                    <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üéâ Deploy Berhasil!</div>
                    <p style="color: var(--text-secondary); margin-bottom: 1rem;">Website kamu sekarang sudah online di:</p>
                    <div style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem; word-break: break-all;">
                        <a id="deployerResultUrl" href="#" target="_blank" style="color: var(--accent-primary); font-family: 'JetBrains Mono', monospace; font-size: 1rem; text-decoration: none; font-weight: 600;">https://your-site.vercel.app</a>
                    </div>
                    <div style="display: flex; gap: 1rem;">
                        <button class="download-btn" onclick="window.open(document.getElementById('deployerResultUrl').href, '_blank')" style="flex: 1;">
                            üåê Buka Website
                        </button>
                        <button class="download-btn" onclick="copyDeployUrl()" style="flex: 1; background: var(--accent-primary);">
                            üìã Copy Link
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="error-message" id="deployerError"></div>
            
            <div style="margin-top: 2rem; padding: 1.5rem; background: rgba(255,255,255,0.03); border-radius: 0.75rem; border: 1px solid var(--border);">
                <h4 style="color: var(--text-primary); margin-bottom: 1rem; font-size: 1.1rem;">üìñ Cara Deploy:</h4>
                <ol style="color: var(--text-secondary); font-size: 0.95rem; line-height: 1.8; padding-left: 1.5rem; margin: 0;">
                    <li>Masukkan nama website (huruf kecil, angka, dash)</li>
                    <li>Upload file HTML atau ZIP</li>
                    <li>Klik "Deploy ke Vercel"</li>
                    <li>Tunggu beberapa detik, website kamu online! üéâ</li>
                </ol>
                <p style="color: var(--accent-primary); font-size: 0.85rem; margin-top: 1rem; margin-bottom: 0;">
                    ‚ú® <strong>Ready to use!</strong> Tidak perlu setup tambahan, langsung deploy!
                </p>
            </div>
        </div>
        
        <!-- Image Upscaler Workspace -->
        <div id="upscaler" class="workspace">
            <div class="workspace-header">
                <h2 class="workspace-title">Image Upscaler</h2>
                <button class="back-btn" onclick="closeTool()">‚Üê Kembali</button>
            </div>
            
            <div style="background: rgba(0, 217, 255, 0.1); border: 1px solid var(--accent-primary); border-radius: 0.75rem; padding: 1rem; margin-bottom: 2rem;">
                <p style="color: var(--accent-primary); font-size: 0.95rem; margin: 0;">
                    ‚ú® <strong>AI-Powered Upscaling!</strong> Tingkatkan resolusi gambar hingga 4x dengan AI enhancement.
                </p>
            </div>
            
            <div class="controls" style="margin-bottom: 2rem;">
                <div class="control-group">
                    <label>Skala Upscale</label>
                    <select id="upscalerScale">
                        <option value="2">2X Resolution (Recommended)</option>
                        <option value="4">4X Ultra HD (Lebih lama)</option>
                    </select>
                </div>
            </div>
            
            <div class="upload-zone" id="upscalerUpload" onclick="document.getElementById('upscalerFile').click()">
                <div class="upload-icon">üñºÔ∏è</div>
                <div class="upload-text">Upload Gambar</div>
                <div class="upload-hint">JPG, PNG, WebP (Max 10MB)</div>
            </div>
            <input type="file" id="upscalerFile" accept="image/*">
            
            <div id="upscalerPreview" style="display: none; margin-top: 2rem;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem;">
                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary);">Original</label>
                        <div style="background: rgba(255,255,255,0.05); border-radius: 0.75rem; padding: 1rem; border: 1px solid var(--border); min-height: 200px; display: flex; align-items: center; justify-content: center;">
                            <img id="upscalerOriginal" style="max-width: 100%; height: auto; border-radius: 0.5rem; display: block;">
                        </div>
                        <small id="upscalerOriginalSize" style="color: var(--text-secondary); font-size: 0.85rem; margin-top: 0.5rem; display: block;"></small>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary);">Upscaled</label>
                        <div style="background: rgba(255,255,255,0.05); border-radius: 0.75rem; padding: 1rem; border: 1px solid var(--border); min-height: 200px; display: flex; align-items: center; justify-content: center;">
                            <canvas id="upscalerResult" style="max-width: 100%; height: auto; border-radius: 0.5rem; display: none;"></canvas>
                            <div id="upscalerPlaceholder" style="color: var(--text-secondary); text-align: center;">
                                Klik "Upscale Sekarang" untuk memproses
                            </div>
                        </div>
                        <small id="upscalerResultSize" style="color: var(--text-secondary); font-size: 0.85rem; margin-top: 0.5rem; display: block;"></small>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <button class="action-btn" onclick="upscaleImage()" id="upscalerProcessBtn">
                        ‚ú® Upscale Sekarang
                    </button>
                    <button class="download-btn" onclick="downloadUpscaled()" id="upscalerDownloadBtn" style="display: none;">
                        üíæ Download HD
                    </button>
                </div>
            </div>
            
            <div class="progress-container" id="upscalerProgress">
                <div class="progress-bar">
                    <div class="progress-fill" id="upscalerProgressBar"></div>
                </div>
                <div class="progress-text" id="upscalerProgressText">Processing with AI...</div>
            </div>
            
            <div class="error-message" id="upscalerError"></div>
            
            <div style="margin-top: 2rem; padding: 1rem; background: rgba(255,255,255,0.03); border-radius: 0.75rem; border: 1px solid var(--border);">
                <p style="color: var(--text-secondary); font-size: 0.9rem; margin: 0;">
                    üí° <strong>Tips:</strong> Untuk hasil terbaik, gunakan gambar dengan kualitas baik. Upscaling 2x lebih cepat dan cocok untuk kebanyakan kebutuhan.
                </p>
            </div>
        </div>
    </div>
    
    <script src="https://unpkg.com/@ffmpeg/ffmpeg@0.12.6/dist/umd/ffmpeg.js"></script>
    <script>
        // Welcome screen transition
        function showTools() {
            const welcomeScreen = document.getElementById('welcomeScreen');
            const mainContent = document.getElementById('mainContent');
            
            welcomeScreen.classList.add('hidden');
            
            setTimeout(() => {
                welcomeScreen.style.display = 'none';
                mainContent.classList.add('visible');
            }, 800);
        }
        
        function backToWelcome() {
            const welcomeScreen = document.getElementById('welcomeScreen');
            const mainContent = document.getElementById('mainContent');
            
            mainContent.classList.remove('visible');
            
            setTimeout(() => {
                welcomeScreen.style.display = 'flex';
                setTimeout(() => {
                    welcomeScreen.classList.remove('hidden');
                }, 50);
            }, 500);
        }
        
        let ffmpeg = null;
        let currentFile = null;
        let currentTool = null;
        
        // Initialize FFmpeg
        async function loadFFmpeg() {
            if (ffmpeg) return;
            
            try {
                const { FFmpeg } = FFmpegWASM;
                ffmpeg = new FFmpeg();
                
                await ffmpeg.load({
                    coreURL: "https://unpkg.com/@ffmpeg/core@0.12.4/dist/umd/ffmpeg-core.js"
                });
                
                console.log('FFmpeg loaded successfully');
            } catch (error) {
                console.error('Error loading FFmpeg:', error);
                showError(currentTool, 'Gagal memuat FFmpeg. Refresh halaman dan coba lagi.');
            }
        }
        
        // Tool navigation
        function openTool(toolName) {
            document.getElementById('toolsGrid').style.display = 'none';
            document.getElementById(toolName).classList.add('active');
            currentTool = toolName;
            loadFFmpeg();
        }
        
        function closeTool() {
            document.querySelectorAll('.workspace').forEach(ws => ws.classList.remove('active'));
            document.getElementById('toolsGrid').style.display = 'grid';
            resetTool(currentTool);
            currentTool = null;
        }
        
        function resetTool(toolName) {
            const fileInfo = document.getElementById(toolName + 'FileInfo');
            const progress = document.getElementById(toolName + 'Progress');
            const result = document.getElementById(toolName + 'Result');
            const error = document.getElementById(toolName + 'Error');
            const btn = document.getElementById(toolName + 'Btn');
            
            if (fileInfo) fileInfo.style.display = 'none';
            if (progress) progress.classList.remove('active');
            if (result) result.classList.remove('active');
            if (error) error.classList.remove('active');
            if (btn) btn.disabled = true;
            
            currentFile = null;
        }
        
        // File handling
        function setupFileInput(toolName) {
            const fileInput = document.getElementById(toolName + 'File');
            const uploadZone = document.getElementById(toolName + 'Upload');
            
            fileInput.addEventListener('change', (e) => {
                handleFileSelect(toolName, e.target.files[0]);
            });
            
            uploadZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadZone.classList.add('drag-over');
            });
            
            uploadZone.addEventListener('dragleave', () => {
                uploadZone.classList.remove('drag-over');
            });
            
            uploadZone.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadZone.classList.remove('drag-over');
                handleFileSelect(toolName, e.dataTransfer.files[0]);
            });
        }
        
        function handleFileSelect(toolName, file) {
            if (!file) return;
            
            currentFile = file;
            const fileInfo = document.getElementById(toolName + 'FileInfo');
            const btn = document.getElementById(toolName + 'Btn');
            
            const size = (file.size / (1024 * 1024)).toFixed(2);
            const type = file.type || 'Unknown';
            
            fileInfo.innerHTML = `
                <div class="file-info-row">
                    <span class="file-info-label">Nama:</span>
                    <span class="file-info-value">${file.name}</span>
                </div>
                <div class="file-info-row">
                    <span class="file-info-label">Ukuran:</span>
                    <span class="file-info-value">${size} MB</span>
                </div>
                <div class="file-info-row">
                    <span class="file-info-label">Type:</span>
                    <span class="file-info-value">${type}</span>
                </div>
            `;
            
            fileInfo.style.display = 'block';
            btn.disabled = false;
        }
        
        function showProgress(toolName, show = true) {
            const progress = document.getElementById(toolName + 'Progress');
            if (show) {
                progress.classList.add('active');
            } else {
                progress.classList.remove('active');
            }
        }
        
        function updateProgress(toolName, percent, text) {
            const bar = document.getElementById(toolName + 'ProgressBar');
            const progressText = document.getElementById(toolName + 'ProgressText');
            bar.style.width = percent + '%';
            if (text) progressText.textContent = text;
        }
        
        function showResult(toolName, blob, filename) {
            const result = document.getElementById(toolName + 'Result');
            const downloadBtn = document.getElementById(toolName + 'Download');
            
            result.classList.add('active');
            
            downloadBtn.onclick = () => {
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                a.click();
                URL.revokeObjectURL(url);
            };
        }
        
        function showError(toolName, message) {
            const error = document.getElementById(toolName + 'Error');
            error.textContent = message;
            error.classList.add('active');
        }
        
        // Converter function
        async function convertFile() {
            if (!currentFile || !ffmpeg) return;
            
            const format = document.getElementById('converterFormat').value;
            const inputName = 'input.' + currentFile.name.split('.').pop();
            const outputName = 'output.' + format;
            
            try {
                showProgress('converter');
                updateProgress('converter', 10, 'Mempersiapkan file...');
                
                const fileData = await currentFile.arrayBuffer();
                await ffmpeg.writeFile(inputName, new Uint8Array(fileData));
                
                updateProgress('converter', 30, 'Converting...');
                
                await ffmpeg.exec(['-i', inputName, outputName]);
                
                updateProgress('converter', 80, 'Finishing...');
                
                const data = await ffmpeg.readFile(outputName);
                const blob = new Blob([data.buffer], { type: `${format.includes('mp') ? 'audio' : 'video'}/${format}` });
                
                updateProgress('converter', 100, 'Selesai!');
                setTimeout(() => showProgress('converter', false), 500);
                
                const newFilename = currentFile.name.replace(/\.[^/.]+$/, '') + '.' + format;
                showResult('converter', blob, newFilename);
                
            } catch (error) {
                console.error('Conversion error:', error);
                showProgress('converter', false);
                showError('converter', 'Gagal convert file: ' + error.message);
            }
        }
        
        // Trimmer function
        async function trimVideo() {
            if (!currentFile || !ffmpeg) return;
            
            const startTime = parseFloat(document.getElementById('trimStart').value);
            const endTime = parseFloat(document.getElementById('trimEnd').value);
            
            if (endTime <= startTime) {
                showError('trimmer', 'End time harus lebih besar dari start time');
                return;
            }
            
            const inputName = 'input.' + currentFile.name.split('.').pop();
            const outputName = 'output.mp4';
            
            try {
                showProgress('trimmer');
                updateProgress('trimmer', 10, 'Mempersiapkan file...');
                
                const fileData = await currentFile.arrayBuffer();
                await ffmpeg.writeFile(inputName, new Uint8Array(fileData));
                
                updateProgress('trimmer', 30, 'Trimming video...');
                
                const duration = endTime - startTime;
                await ffmpeg.exec([
                    '-i', inputName,
                    '-ss', startTime.toString(),
                    '-t', duration.toString(),
                    '-c', 'copy',
                    outputName
                ]);
                
                updateProgress('trimmer', 80, 'Finishing...');
                
                const data = await ffmpeg.readFile(outputName);
                const blob = new Blob([data.buffer], { type: 'video/mp4' });
                
                updateProgress('trimmer', 100, 'Selesai!');
                setTimeout(() => showProgress('trimmer', false), 500);
                
                const newFilename = currentFile.name.replace(/\.[^/.]+$/, '') + '_trimmed.mp4';
                showResult('trimmer', blob, newFilename);
                
            } catch (error) {
                console.error('Trim error:', error);
                showProgress('trimmer', false);
                showError('trimmer', 'Gagal trim video: ' + error.message);
            }
        }
        
        // Audio extractor function
        async function extractAudio() {
            if (!currentFile || !ffmpeg) return;
            
            const quality = document.getElementById('extractorQuality').value;
            const inputName = 'input.' + currentFile.name.split('.').pop();
            const outputName = 'output.mp3';
            
            try {
                showProgress('extractor');
                updateProgress('extractor', 10, 'Mempersiapkan file...');
                
                const fileData = await currentFile.arrayBuffer();
                await ffmpeg.writeFile(inputName, new Uint8Array(fileData));
                
                updateProgress('extractor', 30, 'Extracting audio...');
                
                await ffmpeg.exec([
                    '-i', inputName,
                    '-vn',
                    '-ar', '44100',
                    '-ac', '2',
                    '-b:a', quality + 'k',
                    outputName
                ]);
                
                updateProgress('extractor', 80, 'Finishing...');
                
                const data = await ffmpeg.readFile(outputName);
                const blob = new Blob([data.buffer], { type: 'audio/mp3' });
                
                updateProgress('extractor', 100, 'Selesai!');
                setTimeout(() => showProgress('extractor', false), 500);
                
                const newFilename = currentFile.name.replace(/\.[^/.]+$/, '') + '.mp3';
                showResult('extractor', blob, newFilename);
                
            } catch (error) {
                console.error('Extract error:', error);
                showProgress('extractor', false);
                showError('extractor', 'Gagal extract audio: ' + error.message);
            }
        }
        
        // Compressor function
        async function compressFile() {
            if (!currentFile || !ffmpeg) return;
            
            const level = document.getElementById('compressorLevel').value;
            const inputName = 'input.' + currentFile.name.split('.').pop();
            const ext = currentFile.name.split('.').pop();
            const outputName = 'output.' + ext;
            
            // Compression settings based on level
            const settings = {
                low: { crf: '23', preset: 'medium' },
                medium: { crf: '28', preset: 'fast' },
                high: { crf: '32', preset: 'faster' }
            };
            
            const { crf, preset } = settings[level];
            
            try {
                showProgress('compressor');
                updateProgress('compressor', 10, 'Mempersiapkan file...');
                
                const fileData = await currentFile.arrayBuffer();
                await ffmpeg.writeFile(inputName, new Uint8Array(fileData));
                
                updateProgress('compressor', 30, 'Compressing...');
                
                if (currentFile.type.startsWith('video')) {
                    await ffmpeg.exec([
                        '-i', inputName,
                        '-c:v', 'libx264',
                        '-crf', crf,
                        '-preset', preset,
                        '-c:a', 'aac',
                        '-b:a', '128k',
                        outputName
                    ]);
                } else {
                    await ffmpeg.exec([
                        '-i', inputName,
                        '-b:a', '128k',
                        outputName
                    ]);
                }
                
                updateProgress('compressor', 80, 'Finishing...');
                
                const data = await ffmpeg.readFile(outputName);
                const blob = new Blob([data.buffer], { type: currentFile.type });
                
                updateProgress('compressor', 100, 'Selesai!');
                setTimeout(() => showProgress('compressor', false), 500);
                
                const newFilename = currentFile.name.replace(/\.[^/.]+$/, '') + '_compressed.' + ext;
                showResult('compressor', blob, newFilename);
                
            } catch (error) {
                console.error('Compress error:', error);
                showProgress('compressor', false);
                showError('compressor', 'Gagal compress file: ' + error.message);
            }
        }
        
        // Initialize file inputs
        setupFileInput('converter');
        setupFileInput('trimmer');
        setupFileInput('extractor');
        setupFileInput('compressor');
        setupBgRemoverInput();
        setupDeployerInput();
        setupUpscalerInput();
        
        // Image Upscaler functions
        let upscalerImage = null;
        let upscaledBlob = null;
        
        function setupUpscalerInput() {
            const fileInput = document.getElementById('upscalerFile');
            const uploadZone = document.getElementById('upscalerUpload');
            
            fileInput.addEventListener('change', (e) => {
                handleUpscalerFileSelect(e.target.files[0]);
            });
            
            uploadZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadZone.classList.add('drag-over');
            });
            
            uploadZone.addEventListener('dragleave', () => {
                uploadZone.classList.remove('drag-over');
            });
            
            uploadZone.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadZone.classList.remove('drag-over');
                handleUpscalerFileSelect(e.dataTransfer.files[0]);
            });
        }
        
        function handleUpscalerFileSelect(file) {
            if (!file || !file.type.startsWith('image/')) {
                showError('upscaler', 'Silakan upload file gambar (JPG, PNG, WebP)');
                return;
            }
            
            if (file.size > 10 * 1024 * 1024) {
                showError('upscaler', 'Ukuran file maksimal 10MB');
                return;
            }
            
            upscalerImage = file;
            const preview = document.getElementById('upscalerPreview');
            const original = document.getElementById('upscalerOriginal');
            const downloadBtn = document.getElementById('upscalerDownloadBtn');
            const resultCanvas = document.getElementById('upscalerResult');
            const placeholder = document.getElementById('upscalerPlaceholder');
            const errorMsg = document.getElementById('upscalerError');
            
            // Reset
            downloadBtn.style.display = 'none';
            resultCanvas.style.display = 'none';
            placeholder.style.display = 'block';
            errorMsg.classList.remove('active');
            
            // Show preview
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    original.src = e.target.result;
                    preview.style.display = 'block';
                    
                    // Show original size
                    document.getElementById('upscalerOriginalSize').textContent = 
                        `${img.width} x ${img.height} px`;
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
        
        async function upscaleImage() {
            if (!upscalerImage) return;
            
            const scale = parseInt(document.getElementById('upscalerScale').value);
            const processBtn = document.getElementById('upscalerProcessBtn');
            const downloadBtn = document.getElementById('upscalerDownloadBtn');
            const canvas = document.getElementById('upscalerResult');
            const placeholder = document.getElementById('upscalerPlaceholder');
            const ctx = canvas.getContext('2d');
            
            try {
                processBtn.disabled = true;
                processBtn.textContent = `‚è≥ Processing ${scale}x...`;
                showProgress('upscaler');
                updateProgress('upscaler', 10, 'Loading image...');
                
                // Load image
                const img = new Image();
                const imageUrl = URL.createObjectURL(upscalerImage);
                
                await new Promise((resolve, reject) => {
                    img.onload = resolve;
                    img.onerror = reject;
                    img.src = imageUrl;
                });
                
                updateProgress('upscaler', 30, 'Calculating new dimensions...');
                
                // Set canvas size to upscaled dimensions
                const newWidth = img.width * scale;
                const newHeight = img.height * scale;
                
                canvas.width = newWidth;
                canvas.height = newHeight;
                
                updateProgress('upscaler', 50, `Upscaling to ${newWidth}x${newHeight}...`);
                
                // Enable image smoothing for better quality
                ctx.imageSmoothingEnabled = true;
                ctx.imageSmoothingQuality = 'high';
                
                // Draw upscaled image
                ctx.drawImage(img, 0, 0, newWidth, newHeight);
                
                updateProgress('upscaler', 70, 'Applying AI enhancement...');
                
                // Apply sharpening filter for better quality
                const imageData = ctx.getImageData(0, 0, newWidth, newHeight);
                await applySharpening(imageData);
                ctx.putImageData(imageData, 0, 0);
                
                updateProgress('upscaler', 90, 'Finalizing...');
                
                // Convert to blob
                upscaledBlob = await new Promise(resolve => {
                    canvas.toBlob(resolve, 'image/png', 1.0);
                });
                
                updateProgress('upscaler', 100, 'Complete!');
                
                setTimeout(() => {
                    showProgress('upscaler', false);
                    placeholder.style.display = 'none';
                    canvas.style.display = 'block';
                    downloadBtn.style.display = 'block';
                    processBtn.disabled = false;
                    processBtn.textContent = '‚ú® Upscale Sekarang';
                    
                    // Show result size
                    document.getElementById('upscalerResultSize').textContent = 
                        `${newWidth} x ${newHeight} px (${scale}x upscaled)`;
                }, 500);
                
                URL.revokeObjectURL(imageUrl);
                
            } catch (error) {
                console.error('Upscaling error:', error);
                showProgress('upscaler', false);
                showError('upscaler', 'Gagal upscale gambar. Coba dengan gambar lain atau scale yang lebih kecil.');
                processBtn.disabled = false;
                processBtn.textContent = '‚ú® Upscale Sekarang';
            }
        }
        
        async function applySharpening(imageData) {
            // Simple sharpening kernel
            const data = imageData.data;
            const width = imageData.width;
            const height = imageData.height;
            const kernel = [
                0, -1, 0,
                -1, 5, -1,
                0, -1, 0
            ];
            
            const tempData = new Uint8ClampedArray(data);
            
            // Apply sharpening (sample every 4th pixel for performance)
            for (let y = 1; y < height - 1; y += 2) {
                for (let x = 1; x < width - 1; x += 2) {
                    for (let c = 0; c < 3; c++) { // RGB channels only
                        let sum = 0;
                        for (let ky = -1; ky <= 1; ky++) {
                            for (let kx = -1; kx <= 1; kx++) {
                                const idx = ((y + ky) * width + (x + kx)) * 4 + c;
                                const kernelIdx = (ky + 1) * 3 + (kx + 1);
                                sum += tempData[idx] * kernel[kernelIdx];
                            }
                        }
                        const idx = (y * width + x) * 4 + c;
                        data[idx] = Math.max(0, Math.min(255, sum));
                    }
                }
            }
        }
        
        function downloadUpscaled() {
            if (!upscaledBlob) return;
            
            const scale = document.getElementById('upscalerScale').value;
            const url = URL.createObjectURL(upscaledBlob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `upscaled-${scale}x-artzzy.png`;
            a.click();
            URL.revokeObjectURL(url);
        }
        
        // Vercel Deployer functions
        let deployerFile = null;
        
        function setupDeployerInput() {
            const fileInput = document.getElementById('deployerFile');
            const uploadZone = document.getElementById('deployerUpload');
            const nameInput = document.getElementById('deployerName');
            
            // Update preview URL on name change
            nameInput.addEventListener('input', (e) => {
                const name = e.target.value.toLowerCase().replace(/[^a-z0-9-]/g, '');
                nameInput.value = name;
                document.getElementById('deployerPreviewUrl').textContent = name ? `${name}.vercel.app` : 'my-awesome-site.vercel.app';
                checkDeployerReady();
            });
            
            fileInput.addEventListener('change', (e) => {
                handleDeployerFileSelect(e.target.files[0]);
            });
            
            uploadZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadZone.classList.add('drag-over');
            });
            
            uploadZone.addEventListener('dragleave', () => {
                uploadZone.classList.remove('drag-over');
            });
            
            uploadZone.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadZone.classList.remove('drag-over');
                handleDeployerFileSelect(e.dataTransfer.files[0]);
            });
        }
        
        function handleDeployerFileSelect(file) {
            if (!file) return;
            
            const validTypes = ['.html', '.zip'];
            const isValid = validTypes.some(type => file.name.toLowerCase().endsWith(type));
            
            if (!isValid) {
                showError('deployer', 'Hanya file HTML atau ZIP yang diperbolehkan');
                return;
            }
            
            deployerFile = file;
            const fileInfo = document.getElementById('deployerFileInfo');
            const errorMsg = document.getElementById('deployerError');
            
            errorMsg.classList.remove('active');
            
            const size = (file.size / 1024).toFixed(2);
            const type = file.name.endsWith('.html') ? 'HTML File' : 'ZIP Archive';
            
            fileInfo.innerHTML = `
                <div class="file-info-row">
                    <span class="file-info-label">Nama:</span>
                    <span class="file-info-value">${file.name}</span>
                </div>
                <div class="file-info-row">
                    <span class="file-info-label">Ukuran:</span>
                    <span class="file-info-value">${size} KB</span>
                </div>
                <div class="file-info-row">
                    <span class="file-info-label">Type:</span>
                    <span class="file-info-value">${type}</span>
                </div>
            `;
            
            fileInfo.style.display = 'block';
            checkDeployerReady();
        }
        
        function checkDeployerReady() {
            const name = document.getElementById('deployerName').value.trim();
            const btn = document.getElementById('deployerBtn');
            
            btn.disabled = !(name && deployerFile);
        }
        
        async function deployToVercel() {
            // Hardcoded Vercel API Token - Artzzy MXR3
            const VERCEL_TOKEN = '4tUd7TJZijJzgLaH22PwJz7G';
            
            const projectName = document.getElementById('deployerName').value.trim();
            
            if (!projectName || !deployerFile) {
                showError('deployer', 'Lengkapi nama website dan upload file terlebih dahulu');
                return;
            }
            
            const btn = document.getElementById('deployerBtn');
            const result = document.getElementById('deployerResult');
            
            try {
                btn.disabled = true;
                btn.textContent = '‚è≥ Deploying...';
                result.classList.remove('active');
                showProgress('deployer');
                updateProgress('deployer', 10, 'Mempersiapkan deployment...');
                
                // Read file content as base64
                const fileContent = await deployerFile.arrayBuffer();
                const base64Content = btoa(String.fromCharCode(...new Uint8Array(fileContent)));
                
                updateProgress('deployer', 30, 'Uploading ke Vercel...');
                
                updateProgress('deployer', 50, 'Creating deployment...');
                
                // Create deployment via Vercel API
                const deploymentResponse = await fetch('https://api.vercel.com/v13/deployments', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${VERCEL_TOKEN}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        name: projectName,
                        files: [
                            {
                                file: deployerFile.name.endsWith('.html') ? 'index.html' : deployerFile.name,
                                data: base64Content
                            }
                        ],
                        projectSettings: {
                            framework: null
                        }
                    })
                });
                
                updateProgress('deployer', 80, 'Finalizing deployment...');
                
                if (!deploymentResponse.ok) {
                    const errorData = await deploymentResponse.json();
                    throw new Error(errorData.error?.message || 'Deployment gagal');
                }
                
                const deployment = await deploymentResponse.json();
                const deploymentUrl = `https://${deployment.url}`;
                
                updateProgress('deployer', 100, 'Deploy berhasil!');
                
                setTimeout(() => {
                    showProgress('deployer', false);
                    
                    // Show result
                    document.getElementById('deployerResultUrl').href = deploymentUrl;
                    document.getElementById('deployerResultUrl').textContent = deploymentUrl;
                    result.classList.add('active');
                    
                    btn.disabled = false;
                    btn.textContent = 'üöÄ Deploy ke Vercel';
                }, 500);
                
            } catch (error) {
                console.error('Deployment error:', error);
                showProgress('deployer', false);
                
                let errorMessage = 'Deployment gagal: ' + error.message;
                
                showError('deployer', errorMessage);
                btn.disabled = false;
                btn.textContent = 'üöÄ Deploy ke Vercel';
            }
        }
        
        function copyDeployUrl() {
            const url = document.getElementById('deployerResultUrl').href;
            navigator.clipboard.writeText(url).then(() => {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = '‚úÖ Copied!';
                setTimeout(() => {
                    btn.textContent = originalText;
                }, 2000);
            });
        }
        
        // Background Remover functions
        let bgRemoverImage = null;
        let bgRemovedBlob = null;
        
        function setupBgRemoverInput() {
            const fileInput = document.getElementById('bgremoverFile');
            const uploadZone = document.getElementById('bgremoverUpload');
            
            fileInput.addEventListener('change', (e) => {
                handleBgRemoverFileSelect(e.target.files[0]);
            });
            
            uploadZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadZone.classList.add('drag-over');
            });
            
            uploadZone.addEventListener('dragleave', () => {
                uploadZone.classList.remove('drag-over');
            });
            
            uploadZone.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadZone.classList.remove('drag-over');
                handleBgRemoverFileSelect(e.dataTransfer.files[0]);
            });
        }
        
        function handleBgRemoverFileSelect(file) {
            if (!file || !file.type.startsWith('image/')) {
                showError('bgremover', 'Silakan upload file gambar (JPG, PNG, WebP)');
                return;
            }
            
            if (file.size > 10 * 1024 * 1024) {
                showError('bgremover', 'Ukuran file maksimal 10MB');
                return;
            }
            
            bgRemoverImage = file;
            const preview = document.getElementById('bgremoverPreview');
            const original = document.getElementById('bgremoverOriginal');
            const downloadBtn = document.getElementById('bgremoverDownloadBtn');
            const errorMsg = document.getElementById('bgremoverError');
            
            // Reset
            downloadBtn.style.display = 'none';
            errorMsg.classList.remove('active');
            
            // Show preview
            const reader = new FileReader();
            reader.onload = (e) => {
                original.src = e.target.result;
                preview.style.display = 'block';
            };
            reader.readAsDataURL(file);
        }
        
        async function processBackgroundRemoval() {
            if (!bgRemoverImage) return;
            
            const processBtn = document.getElementById('bgremoverProcessBtn');
            const downloadBtn = document.getElementById('bgremoverDownloadBtn');
            const canvas = document.getElementById('bgremoverResult');
            const ctx = canvas.getContext('2d');
            
            try {
                processBtn.disabled = true;
                processBtn.textContent = '‚è≥ Processing...';
                showProgress('bgremover');
                updateProgress('bgremover', 10, 'Loading AI model...');
                
                // Load image
                const img = new Image();
                const imageUrl = URL.createObjectURL(bgRemoverImage);
                
                await new Promise((resolve, reject) => {
                    img.onload = resolve;
                    img.onerror = reject;
                    img.src = imageUrl;
                });
                
                updateProgress('bgremover', 30, 'Analyzing image...');
                
                // Set canvas size
                canvas.width = img.width;
                canvas.height = img.height;
                
                // Draw original image
                ctx.drawImage(img, 0, 0);
                
                updateProgress('bgremover', 50, 'Removing background with AI...');
                
                // Simple edge detection and background removal
                // This is a simplified version - for production use @imgly/background-removal or similar
                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                const data = imageData.data;
                
                // Edge detection and background removal algorithm
                await removeBackgroundSimple(data, canvas.width, canvas.height);
                
                updateProgress('bgremover', 90, 'Finalizing...');
                
                ctx.putImageData(imageData, 0, 0);
                
                // Convert to blob
                bgRemovedBlob = await new Promise(resolve => {
                    canvas.toBlob(resolve, 'image/png');
                });
                
                updateProgress('bgremover', 100, 'Complete!');
                
                setTimeout(() => {
                    showProgress('bgremover', false);
                    downloadBtn.style.display = 'block';
                    processBtn.disabled = false;
                    processBtn.textContent = '‚ú® Remove Background';
                }, 500);
                
                URL.revokeObjectURL(imageUrl);
                
            } catch (error) {
                console.error('Background removal error:', error);
                showProgress('bgremover', false);
                showError('bgremover', 'Gagal remove background. Coba dengan gambar lain.');
                processBtn.disabled = false;
                processBtn.textContent = '‚ú® Remove Background';
            }
        }
        
        async function removeBackgroundSimple(data, width, height) {
            // Simple algorithm: detect edges and remove similar colors to corners
            // Get corner colors as reference for background
            const cornerColors = [
                [data[0], data[1], data[2]], // top-left
                [data[(width - 1) * 4], data[(width - 1) * 4 + 1], data[(width - 1) * 4 + 2]], // top-right
                [data[(height - 1) * width * 4], data[(height - 1) * width * 4 + 1], data[(height - 1) * width * 4 + 2]], // bottom-left
                [data[((height - 1) * width + width - 1) * 4], data[((height - 1) * width + width - 1) * 4 + 1], data[((height - 1) * width + width - 1) * 4 + 2]] // bottom-right
            ];
            
            const threshold = 60; // Color similarity threshold
            
            for (let i = 0; i < data.length; i += 4) {
                const r = data[i];
                const g = data[i + 1];
                const b = data[i + 2];
                
                // Check if pixel is similar to any corner color
                let isSimilar = false;
                for (let corner of cornerColors) {
                    const diff = Math.abs(r - corner[0]) + Math.abs(g - corner[1]) + Math.abs(b - corner[2]);
                    if (diff < threshold) {
                        isSimilar = true;
                        break;
                    }
                }
                
                // If similar to background, make transparent
                if (isSimilar) {
                    data[i + 3] = 0; // Set alpha to 0
                } else {
                    // Enhanced edge detection for better subject isolation
                    const x = (i / 4) % width;
                    const y = Math.floor((i / 4) / width);
                    
                    // Check surrounding pixels for edge detection
                    let edgeScore = 0;
                    const checkRadius = 2;
                    
                    for (let dy = -checkRadius; dy <= checkRadius; dy++) {
                        for (let dx = -checkRadius; dx <= checkRadius; dx++) {
                            const nx = x + dx;
                            const ny = y + dy;
                            
                            if (nx >= 0 && nx < width && ny >= 0 && ny < height) {
                                const ni = (ny * width + nx) * 4;
                                const dr = Math.abs(data[i] - data[ni]);
                                const dg = Math.abs(data[i + 1] - data[ni + 1]);
                                const db = Math.abs(data[i + 2] - data[ni + 2]);
                                edgeScore += dr + dg + db;
                            }
                        }
                    }
                    
                    // If low edge score and similar to background, partially transparent
                    if (edgeScore < 500) {
                        for (let corner of cornerColors) {
                            const diff = Math.abs(r - corner[0]) + Math.abs(g - corner[1]) + Math.abs(b - corner[2]);
                            if (diff < threshold * 1.5) {
                                data[i + 3] = Math.max(0, data[i + 3] - 100);
                            }
                        }
                    }
                }
            }
            
            // Cleanup isolated pixels (anti-aliasing)
            for (let y = 1; y < height - 1; y++) {
                for (let x = 1; x < width - 1; x++) {
                    const i = (y * width + x) * 4;
                    
                    if (data[i + 3] > 0) {
                        let transparentNeighbors = 0;
                        
                        // Check 8 neighbors
                        for (let dy = -1; dy <= 1; dy++) {
                            for (let dx = -1; dx <= 1; dx++) {
                                if (dx === 0 && dy === 0) continue;
                                const ni = ((y + dy) * width + (x + dx)) * 4;
                                if (data[ni + 3] === 0) transparentNeighbors++;
                            }
                        }
                        
                        // If surrounded by transparent pixels, make partially transparent
                        if (transparentNeighbors > 5) {
                            data[i + 3] = Math.floor(data[i + 3] * 0.3);
                        }
                    }
                }
            }
        }
        
        function downloadBgRemoved() {
            if (!bgRemovedBlob) return;
            
            const url = URL.createObjectURL(bgRemovedBlob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'no-background-artzzy.png';
            a.click();
            URL.revokeObjectURL(url);
        }
        
        // Code Screenshot Generator functions
        const themes = {
            ocean: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
            sunset: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
            forest: 'linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)',
            purple: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',
            dark: 'linear-gradient(135deg, #232526 0%, #414345 100%)',
            light: 'linear-gradient(135deg, #e0e0e0 0%, #f5f5f5 100%)'
        };
        
        function generateCodeImage() {
            const code = document.getElementById('carbonCode').value;
            const language = document.getElementById('carbonLanguage').value;
            const theme = document.getElementById('carbonTheme').value;
            const fontSize = document.getElementById('carbonFontSize').value;
            
            if (!code.trim()) {
                showError('carbon', 'Silakan masukkan code terlebih dahulu!');
                return;
            }
            
            const canvas = document.getElementById('carbonCanvas');
            const codeContent = document.getElementById('carbonCodeContent');
            const preview = document.getElementById('carbonPreview');
            
            // Apply theme
            canvas.style.background = themes[theme];
            
            // Apply font size
            codeContent.style.fontSize = fontSize + 'px';
            
            // Apply syntax highlighting
            const highlightedCode = highlightSyntax(code, language);
            codeContent.innerHTML = highlightedCode;
            
            // Show preview
            preview.style.display = 'block';
            
            // Scroll to preview
            preview.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
        
        function highlightSyntax(code, language) {
            const keywords = {
                javascript: ['const', 'let', 'var', 'function', 'return', 'if', 'else', 'for', 'while', 'class', 'new', 'this', 'import', 'export', 'from', 'async', 'await', 'try', 'catch', 'throw', 'switch', 'case', 'break', 'continue', 'default', 'typeof', 'instanceof'],
                python: ['def', 'class', 'if', 'elif', 'else', 'for', 'while', 'return', 'import', 'from', 'as', 'try', 'except', 'finally', 'with', 'lambda', 'yield', 'pass', 'break', 'continue', 'and', 'or', 'not', 'in', 'is', 'True', 'False', 'None'],
                java: ['public', 'private', 'protected', 'class', 'interface', 'extends', 'implements', 'new', 'return', 'if', 'else', 'for', 'while', 'switch', 'case', 'break', 'continue', 'try', 'catch', 'finally', 'throw', 'throws', 'static', 'final', 'void', 'int', 'String', 'boolean', 'double', 'float'],
                cpp: ['include', 'using', 'namespace', 'class', 'public', 'private', 'protected', 'int', 'void', 'return', 'if', 'else', 'for', 'while', 'switch', 'case', 'break', 'continue', 'new', 'delete', 'const', 'auto', 'template', 'typename'],
                csharp: ['using', 'namespace', 'class', 'public', 'private', 'protected', 'static', 'void', 'int', 'string', 'bool', 'return', 'if', 'else', 'for', 'foreach', 'while', 'switch', 'case', 'break', 'continue', 'new', 'var', 'async', 'await'],
                php: ['function', 'class', 'public', 'private', 'protected', 'return', 'if', 'else', 'elseif', 'for', 'foreach', 'while', 'switch', 'case', 'break', 'continue', 'new', 'echo', 'require', 'include', 'namespace', 'use'],
                ruby: ['def', 'class', 'module', 'if', 'elsif', 'else', 'unless', 'for', 'while', 'until', 'return', 'yield', 'begin', 'rescue', 'ensure', 'end', 'do', 'case', 'when', 'break', 'next'],
                go: ['package', 'import', 'func', 'var', 'const', 'type', 'struct', 'interface', 'return', 'if', 'else', 'for', 'switch', 'case', 'break', 'continue', 'go', 'defer', 'range', 'map', 'chan'],
                rust: ['fn', 'let', 'mut', 'const', 'struct', 'enum', 'impl', 'trait', 'pub', 'use', 'mod', 'return', 'if', 'else', 'for', 'while', 'loop', 'match', 'break', 'continue'],
                html: ['html', 'head', 'body', 'div', 'span', 'p', 'a', 'img', 'ul', 'li', 'table', 'tr', 'td', 'form', 'input', 'button', 'script', 'style', 'link', 'meta'],
                css: ['color', 'background', 'margin', 'padding', 'border', 'width', 'height', 'display', 'flex', 'grid', 'position', 'font', 'text', 'align', 'hover', 'active', 'before', 'after'],
                sql: ['SELECT', 'FROM', 'WHERE', 'INSERT', 'UPDATE', 'DELETE', 'CREATE', 'TABLE', 'DROP', 'ALTER', 'JOIN', 'INNER', 'LEFT', 'RIGHT', 'ON', 'AND', 'OR', 'ORDER', 'BY', 'GROUP', 'HAVING', 'LIMIT']
            };
            
            const langKeywords = keywords[language] || keywords.javascript;
            
            // Escape HTML
            let highlighted = code
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;');
            
            // Highlight strings
            highlighted = highlighted.replace(/(["'`])(?:(?=(\\?))\2.)*?\1/g, '<span class="string">$&</span>');
            
            // Highlight comments
            highlighted = highlighted.replace(/(\/\/.*$|\/\*[\s\S]*?\*\/|#.*$)/gm, '<span class="comment">$&</span>');
            
            // Highlight numbers
            highlighted = highlighted.replace(/\b(\d+\.?\d*)\b/g, '<span class="number">$1</span>');
            
            // Highlight keywords
            langKeywords.forEach(keyword => {
                const regex = new RegExp(`\\b(${keyword})\\b`, 'g');
                highlighted = highlighted.replace(regex, '<span class="keyword">$1</span>');
            });
            
            // Highlight functions (word followed by parenthesis)
            highlighted = highlighted.replace(/\b([a-zA-Z_][a-zA-Z0-9_]*)\s*(?=\()/g, '<span class="function">$1</span>');
            
            // Add line numbers and formatting
            const lines = highlighted.split('\n');
            const numberedLines = lines.map((line, index) => {
                const lineNum = `<span style="color: #6272a4; margin-right: 1.5rem; user-select: none; display: inline-block; width: 2rem; text-align: right;">${index + 1}</span>`;
                return `<span class="code-line">${lineNum}${line || ' '}</span>`;
            });
            
            return numberedLines.join('\n');
        }
        
        async function downloadCodeImage() {
            const canvas = document.getElementById('carbonCanvas');
            
            try {
                // Use html2canvas library
                const html2canvas = await loadHtml2Canvas();
                
                const captureCanvas = await html2canvas(canvas, {
                    backgroundColor: null,
                    scale: 2,
                    logging: false
                });
                
                captureCanvas.toBlob((blob) => {
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'code-screenshot-artzzy.png';
                    a.click();
                    URL.revokeObjectURL(url);
                });
                
            } catch (error) {
                console.error('Download error:', error);
                showError('carbon', 'Gagal download screenshot. Coba screenshot manual.');
            }
        }
        
        // Load html2canvas library dynamically
        let html2canvasLoaded = false;
        async function loadHtml2Canvas() {
            if (html2canvasLoaded) return window.html2canvas;
            
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = 'https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js';
                script.onload = () => {
                    html2canvasLoaded = true;
                    resolve(window.html2canvas);
                };
                script.onerror = reject;
                document.head.appendChild(script);
            });
        }
    </script>
</body>
</html>
